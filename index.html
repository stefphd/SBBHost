<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SBB Host: General</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript">
    DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="sbbhost-icon.svg"/></td>
  <td id="projectalign">
   <div id="projectname">SBB Host
   </div>
   <div id="projectbrief">Host communication with the self balancing bike.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">General </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_README"></a> Application for host communication with the self-balancing-bike microcontroller.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
About</h1>
<p >SBB Host is a desktop application used for the communication with the self-balancing-bike microcontroller via USB. It can be used for signal streaming from the microcontroller, control of the motor drivers, and reading of the log files (having extension *.sbb).</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Files</h1>
<p >Files:</p>
<ul>
<li><code>SBBHost.sln</code>, <code>SBBHost.vcxproj</code>, <code>SBBHost.vcxproj.filters</code>,<code>SBBHost.vcxproj.user</code> ,<code>SBBHost.rc</code> ,<code>resource.h</code>: project files necessary for <em>Visual Studio</em> (in Windows only)</li>
<li><code>Makefile</code>: makefile necessary for compilation and installation in Linux</li>
<li><code>Doxyfile</code>: configuration file for documentation generation from source code using <em>doxygen</em></li>
<li><code>configure</code>: configure script (to use before building or installation)</li>
<li><code>installation_path.txt</code>: installation path (updated by <code>configure</code>). Do not delete this file!</li>
</ul>
<p >Code folders:</p>
<ul>
<li><code>./include</code>: contains <code>.h</code> files included in source code</li>
<li><code>./src</code>: contains source <code>.c</code> or <code>.cpp</code> files, inclduing main file <code><a class="el" href="main_8cpp.html" title="Main file of the application.">main.cpp</a></code></li>
<li><code>./lib</code>: contains a folder for each used library</li>
</ul>
<p >Additional folders:</p>
<ul>
<li><code>./resource</code>: contains additional resource files necessary for the application</li>
<li><code>./docs/html</code>: contains the documentation in html (generated automatically from source code using <em>doxygen</em>)</li>
<li><code>./bin</code>: contains binary files</li>
<li><code>./.build</code>: contains temporary files created during compilation</li>
<li><code>./.vscode</code>: contains VS code property file(s)</li>
</ul>
<p >Installer files and folders:</p>
<ul>
<li><code>./installer</code>: folder containing the installer files</li>
<li><code>./installer/installer.vdproj</code>: installer project necessary for <em>Visual Studio</em> (in Windows only)</li>
<li><code>./installer/win64</code>: contains the Windows x64 installer</li>
<li><code>./installer/linux</code>: contains the Linux installation files</li>
</ul>
<p >Note that some of the above folders are created during building only.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Prerequisites</h1>
<p >Building and installation work on Windows x64 or Linux.</p>
<p >For only installation in Windows x64 no prerequisites are necessary: all binary files are provided with the installer.</p>
<p >For Linux installation it is necessary to install</p>
<ul>
<li><p class="startli"><em>make</em>: this usually can be simple done by using in the terminal</p>
<div class="fragment"><div class="line">sudo pacman -Sy make</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>The code above works with Arch Linux distributions, similar commands may be used in other Linux distributions (e.g. <code>apt install make</code> in Debian/Ubuntu).</dd></dl>
</li>
<li><em>gtkmm4</em> libraries, including all its dependencies</li>
<li><em>fftw3</em> libraries See <em>Installation of libraries</em> for details on the installation of libraries.</li>
</ul>
<p >For building the code and the installer, the following prerequisites are necessary:</p>
<ul>
<li><em>Visual Studio</em> (&gt;=2017) for Windows, or alternatively <a href="https://www.mingw-w64.org/">Mingw-w64</a> (e.g. with <a href="[https://www.msys2.org/](https://www.msys2.org/)">MSYS2</a>)</li>
<li><em>gtkmm4</em> libraries, including all its dependencies</li>
<li><em>fftw3</em> libraries for Linux and Mingw-w64, while libraries are already given in <code>./lib</code> for Windows using <em>Visual Studio</em></li>
<li><em>g++</em> with <em>make</em> for Linux and Mingw-w64</li>
<li><em>doxygen</em> for documentation generations</li>
</ul>
<p >For building in Linux or with Mingw-w64 it is racommended to have also <em>Visual Studio Code</em> with <em>C/C+ (ms-vscode)</em> installed. This is not mandatory for compilation but it helps for code completation and make the compilation simpler.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Installation (user)</h1>
<ul>
<li>ArchLinux: installation can be performed using the AUR with pacman.</li>
<li><p class="startli">For other distributions the installation is manual and involves:</p>
<div class="fragment"><div class="line">.\configure</div>
<div class="line">make build</div>
<div class="line">make install</div>
</div><!-- fragment --><p class="startli">Use <code>make uninstall</code> for unistalling. Installation requires root permission. This actually adds the following files to the root</p><ul>
<li><code>/usr/local/bin/sbbhost</code></li>
<li><code>/usr/local/share/sbbhost-config.ini</code></li>
<li><code>/usr/local/share/sbbhost/sbbhost-toolbar.xml</code></li>
<li><code>/usr/local/share/doc/sbbhost/README.md</code></li>
<li><code>/usr/local/share/applications/sbbhost.desktop</code></li>
<li><code>/usr/local/share/pixmaps/sbbhost-icon.svg</code></li>
</ul>
<p class="startli">You may perform local installation (i.e. not system-wide) using <code>.\configure --prefix $HOME/.local</code>.</p>
</li>
<li><p class="startli">Windows x64: just use <code>./installer/win64/SBBHost Installer.msi</code> to install the application in Windows using a setup wizard. </p><dl class="section attention"><dt>Attention</dt><dd>It is highly racommended to not change the installation directory. However, if you want to change the installation directory during the setup wizard, you must change the variable <code>gsettings_dir</code> in the file <code>path_to_installation/sbbhost-config.ini</code> with</dd></dl>
<div class="fragment"><div class="line">gsettings_dir = &#39;path_to_installation\share&#39;;</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>For Windows, building is not mandatory for installation, since pre-compiled binaries are provided.</dd></dl>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Configuration file</h1>
<p >After installation, the configuration file <code>path/to/installation/sbbhost-config.ini</code> may be changed in order to configure the application with special features. These include:</p>
<ul>
<li>Default values for buadrate and timeout of the serial port</li>
<li>Header and terminator bytes of the data packet</li>
<li>Enable the darkmode on startup</li>
<li>Modify the signal list</li>
<li>Modify the control list and their upper, lower limits and default values</li>
<li>Modify the default size of windows and dialogs, as well as the appearance of the graph</li>
</ul>
<p >However, modifications should be done carefully by expert users. In Linux, the configuration file is in <code>/usr/share</code> (for ArchLinux) or <code>/usr/local/share</code>.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Documentation (for development)</h1>
<p >Documentation for the source code (but not for the used libraries in <code>./lib</code>) can be generated from the source using <em>doxygen</em> (see <a href="https://www.doxygen.nl/download.html">https://www.doxygen.nl/download.html</a> for download) with</p>
<div class="fragment"><div class="line">doxygen</div>
</div><!-- fragment --><p >or also using <em>make</em></p>
<div class="fragment"><div class="line">make doc</div>
</div><!-- fragment --><p >Generated documentation includes only a html version in <code>./docs/html</code>, with main fil <code>index.html</code>. Documentation is also available on <a href="https://stefphd.github.io/SBBHost/">https://stefphd.github.io/SBBHost/</a>. A latex documentation may be also generated by setting</p>
<div class="fragment"><div class="line">GENERATE_LATEX  = YES</div>
</div><!-- fragment --><p >in <code>Doxyfile</code>. The latex version will be in <code>./docs/latex</code> and can be compiled using latex with</p>
<div class="fragment"><div class="line">cd ./docs/latex</div>
<div class="line">make</div>
</div><!-- fragment --><p >which generates the pdf file <code>./doc/latex/refman.pdf</code>. Note that this requires having latex installed.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Installation of libraries (for development)</h2>
<p ><em>gtkmm4</em> libraries (including all its dependencies) can be installed with:</p>
<ul>
<li><p class="startli">Linux:</p>
<div class="fragment"><div class="line">sudo pacman -Sy gtkmm-4.0</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>The code above works with Arch Linux distributions, similar commands may be used in other Linux distributions.</dd></dl>
</li>
<li>Windows: use <em>vcpkg</em> (see <a href="https://github.com/microsoft/vcpkg">https://github.com/microsoft/vcpkg</a>) for installation with <em>Visual Studio</em>. Other actions may be necessary to make <em>Visual Studio</em> working properly. See <em>Workaround with gtkmm in Visual Studio</em> for details.</li>
</ul>
<p ><em>fftw3</em> library can be installed with:</p>
<ul>
<li><p class="startli">Linux:</p>
<div class="fragment"><div class="line">sudo pacman -Sy fftw</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>The code above works with Arch Linux distributions, similar commands may be used in other Linux distributions.</dd></dl>
</li>
<li>Windows: no installation is required, since pre-compiled binaries are provided.</li>
</ul>
<p >Alternatively, for Windows you may also use <a href="https://www.mingw-w64.org/">Mingw-w64</a> with <a href="https://www.msys2.org/">MSYS2</a> instead of <em>Visual Studio</em>. This requires having the <code>mingw-w64-x86_64-gtkmm-4.0</code> and <code>mingw-w64-x86_64-fftw</code> packages installed.</p>
<h1><a class="anchor" id="autotoc_md8"></a>
Building (for develpement)</h1>
<ul>
<li><p class="startli">Linux and Mingw-w64: building makes use of a makefile. Before building the executable for standalone usage (i.e. without installation), it is necessary to run the configure with</p>
<div class="fragment"><div class="line">./configure --prefix .</div>
</div><!-- fragment --><p class="startli">Depending on what you would like to do, there are different options</p><ul>
<li>Build the code: <code>make build</code> in the terminal (does not rebuild if files do not change)</li>
<li>Clean object files: <code>make clean</code></li>
<li>Clean built files (including binaries): <code>make cleaner</code></li>
<li>Rebuild: <code>make remake</code> (regardless if files have changed or not)</li>
<li>Build the code and generate the documentation: just use <code>make</code> or <code>make all</code></li>
</ul>
<p class="startli">If installed, you may also use <em>Visual Studio Code</em> using <code>ctrl+shift+B</code> to build and generate the documentation (this corresponds to <code>make all</code>).</p>
</li>
<li>Windows with <em>Visual Studio</em>: just use <em>Visual Studio</em> in x64-Realase mode. Make sure to use the <em>C++17 (ISO/IEC 14882)</em> compiler. The installer is built using <em>Visual Studio</em> too.</li>
</ul>
<h1><a class="anchor" id="autotoc_md9"></a>
Workaround with &lt;em&gt;gtkmm&lt;/em&gt; in &lt;em&gt;Visual Studio&lt;/em&gt;</h1>
<p >The <em>gtkmm-4.0</em> libraries have been initially meant to be used in Linux systems, therefore it is not trivial to use them in Windows, especially with <em>Visual Studio</em>. The workaround is to use <em>vcpkg</em>, which is a tool for installing packages in Windows.</p>
<p >Accordingly to the README file in <a href="https://github.com/microsoft/vcpkg">https://github.com/microsoft/vcpkg</a>, installation is performed with:</p>
<ul>
<li>Install the prerequisites, i.e. <em>Git</em> (see <a href="https://git-scm.com/downloads">https://git-scm.com/downloads</a>), and <em>Visual Studio</em> (&gt;=2015 declared, &gt;=2017 for <em>gtkmm4</em>). Git is only used to clone the repository at <a href="https://github.com/microsoft/vcpkg">https://github.com/microsoft/vcpkg</a> in the PC: you can also download the repository directly.</li>
<li><p class="startli">Create a path where to install <em>vcpkg</em>. Mandatory path is <code>C:\src\vcpkg</code>, e.g. using</p>
<div class="fragment"><div class="line">mkdir C:\src\vcpkg</div>
</div><!-- fragment --></li>
<li><p class="startli">Go to <code>C:\src</code>, e.g. using</p>
<div class="fragment"><div class="line">cd C:\src</div>
</div><!-- fragment --></li>
<li><p class="startli">Clone the repository using <em>Git</em></p>
<div class="fragment"><div class="line">git clone https://github.com/microsoft/vcpkg</div>
</div><!-- fragment --></li>
<li><p class="startli">Bootstrap <em>vcpkg</em> using</p>
<div class="fragment"><div class="line">.\vcpkg\bootstrap-vcpkg.bat</div>
</div><!-- fragment --></li>
<li><p class="startli">Install the <em>gtkmm4</em> libraries (x64 version)</p>
<div class="fragment"><div class="line">.\vcpkg\vcpkg install gtkmm --triplet=x64-windows</div>
</div><!-- fragment --><p class="startli">This includes download and building of all the necessary dependencies. Installation can takes some time.</p>
</li>
<li><p class="startli">Install <em>integrate</em> to use <em>vcpkg</em> with <em>Visual Studio</em> (with administrator elevation) using</p>
<div class="fragment"><div class="line">.\vcpkg\vcpkg integrate install</div>
</div><!-- fragment --></li>
</ul>
<p >After having installed <em>gtkmm-4.0</em>, the libraries should appear in <code>C:\src\vcpkg\installed\x64-windows</code>. There the folder <code>./include</code> contains all the include files to use in the C/C++ source, while <code>./bin</code> and <code>./tools</code> contain the corresponding binaries file (i.e. <code>*.dll</code>). You can also find the static libraries in <code>./lib</code>.</p>
<p >You can test if <em>Visual Studio</em> works by compiling the HelloWorld example in <a href="https://gitlab.gnome.org/GNOME/gtkmm-documentation/tree/master/examples/book/helloworld">https://gitlab.gnome.org/GNOME/gtkmm-documentation/tree/master/examples/book/helloworld</a>. Make sure to:</p>
<ul>
<li>use <em>Visual Studio</em> in x64-Realase mode.</li>
<li>use the <em>C++17 (ISO/IEC 14882)</em> compiler.</li>
</ul>
<p >If issues are found, these are probably due to an incorrect include directory created by <em>vcpkg</em> for the <em>Visual Studio</em> compiler. The workaround is to install <em>pkg-config</em>, which is a tool for generating the include directories for C/C++ libraries:</p>
<ul>
<li><p class="startli">Install <em>pkgconf</em> (alias for <em>pkg-config</em> in <em>vcpkg</em>) using</p>
<div class="fragment"><div class="line">.\vcpkg\vcpkg install pkgconf --triplet=x64-windows</div>
</div><!-- fragment --></li>
<li><p class="startli">Go to <code>C:\src\vcpkg\installed\x64-windows\tools\pkgconf</code></p>
<div class="fragment"><div class="line">cd `C:\src\vcpkg\installed\x64-windows\tools\pkgconf`</div>
</div><!-- fragment --></li>
<li><p class="startli">Run <em>pkg-config</em> with <em>gtkmm4</em> using</p>
<div class="fragment"><div class="line">pkgconf --cflags-only-I gtkmm-4.0 --with-path=C:\src\vcpkg\installed\x64-windows\lib\pkgconfig</div>
</div><!-- fragment --><p class="startli">This prints a list of include diretories (e.g. <code>-IC:/src/vcpkg/installed/**</code>), which is the flag to pass to the C/C++ compiler for including the necessary directories.</p>
</li>
<li><p class="startli">You may also print a nicer list of include directories using in the <em><b>Windows PowerShell</b></em></p>
<div class="fragment"><div class="line">$(./pkgconf --cflags-only-I gtkmm-4.0 --with-path=C:\src\vcpkg\installed\x64-windows\lib\pkgconfig) -replace &quot;-I&quot;, &quot;`n&quot;</div>
</div><!-- fragment --><dl class="section attention"><dt>Attention</dt><dd>Make sure to use the <em><b>Windows PowerShell</b></em>, not the <em>Command Prompt</em>.</dd></dl>
</li>
<li><p class="startli">In <em>Visual Studio</em> put these directories in <em>Additional Include Directory</em> for the C/C++ compiler. You may also add the following additional compiler flag</p>
<div class="fragment"><div class="line">`C:\src\vcpkg\installed\x64-windows\tools\pkgconf\pkgconf --cflags-only-I gtkmm-4.0 --with-path=C:\src\vcpkg\installed\x64-windows\lib\pkgconfig`</div>
</div><!-- fragment --><p class="startli">or alternatively the output of</p>
<div class="fragment"><div class="line">pkgconf --cflags-only-I gtkmm-4.0 --with-path=C:\src\vcpkg\installed\x64-windows\lib\pkgconfig</div>
</div><!-- fragment --></li>
</ul>
<h2><a class="anchor" id="autotoc_md10"></a>
Tips</h2>
<ul>
<li>You may also install the x32 version of the packages. In such case use <code>.\vcpkg\vcpkg install gtkmm</code>and<code>.\vcpkg\vcpkg install pkgconf</code> and replace all <code>x64-windows</code> with <code>x86-windows</code> in all commands.</li>
<li>When using <code>gtkmm</code> you may need to add an environment variable named <code>GSETTINGS_SCHEMA_DIR</code> pointing to <code>C:\src\vcpkg\installed\x64-windows\share\glib-2.0\schemas</code>. You may also make a local copy of this directory in your project folder, which can be copied in the binary folder. This environment variable may be either global or local (you can use <code>putenv</code> command in C)</li>
</ul>
<h1><a class="anchor" id="autotoc_md11"></a>
Known issues</h1>
<ul>
<li>Help me to find issues</li>
<li><p class="startli">2+2=5</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Change makefile to make it compatible with Mingw-w64. Copying dlls when building. TODO is to add -mwindows in cflags and change TARGETDIR if OS=WINDOWS.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd><p class="startdd">add more gestures to move and zoom in plots: e.g. press roll to move, and roll to zoom </p>
<p class="interdd">drag and drop in Windows </p>
<p class="interdd">Implement help but for linux and installation </p>
<p class="interdd">Implement direct open of a *.sbb file (argv and argc)???? </p>
<p class="interdd">Add plot settings (plot_graph_decim, etc) </p>
<p class="enddd">Implement PSD in plot mode </p>
</dd></dl>
</li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
